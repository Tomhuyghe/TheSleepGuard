% Donn√©es de BeatAVG
BeatAVG_data = [
    63.74
60.84
62.34
67.15
75.04
60.12
69.33
64.81
70.12
74.87
77.4
80.82
76.67
72.57
75.1
65.95
68.86
78.83
81.21
82.09
82.47
79.23
81.92
77.8
77.77
77.75
76.98
68.25
74.14
72.83
80.52
77.99
83.64
87.59
89.65
93.8
90.42
77.53
67.78
66.48
64.9
69.77
71.58
74.36
72.45
68.8
67.64
67.94
59.56
56.02
62.68
66.49
67.09
65.77
59.93
64.75
59.16
56.24
65.6
59.59
53.61
55.68
67.56
71.9
79.86
77.53
74.83
70.91
72.35
74.79
71.24
71.31
71.08
67.74
59.17
58.8
59.86
60.41
72.15
72.37
78.74
81.29
78.67
72.08
63.3
64.12
63.22
59.92
55.67
61.38
49.61
48.6
55.66
54.33
54.38
53.12
65.19
59.35
60.17
60.12
61.25
63.65
65.45
61.34
61.11
55.86
60.81
66.73
71.49
69.98
63.33
59.81
54.14
63.64
58.68
56.98
56.17
51.98
55.9
65.82
64.27
66.98
64.45
76.76
65.88
74.47
60.18
68.57
67.95
59.98
62.25
60.89
54.24
51.32
51.05
58.15
58.37
56.89
61.28
58.45
54.1
57.1
68.62
71.79
80.33
84.96
79.29
72.61
72.13
66.77
71.08
61.35
62.12
62.02
63.08
58.82
60.83
63.74
66.89
65.56
61.28
59.85
62.23
60.29
63.22
59.05
58.23
53.17
53.81
54.41
57.7
66.01
64.69
67.74
69.41
66.06
69.21
68.45
69.62
71.25
69.68
71.69
76.23
70.5
71.74
66.84
66.04
59.88
62.01
63.3
61.96
62.33
61.35
69.67
60.93
68.57
64.85
64.04
69.05
64.93
67.01
65.7
71.34
67.45
73.17
72.76
67.46
78.56
74.05
79.34
78.35
75.88
77.31
82.57
78.41
81.56
81.69
78.61
71.06
75.28
68.17
71.52
68.65
65.42
61.82
59.67
57.24
56.26
58.25
64.82
65.25
75.92
72.41
78.58
71.23
66.19
66.2
62.24
63.24
62.94
56.22
56.21
50.52
52.01
51.03
55.78
54.34
52.03
55.11
59.72
57.21
54.03
56.75
49.04
58.08
56.81
58.67
66.11
61.03
72.79
66.31
65.06
69.94
69.03
74.32
67.65
67.94
63.71
69.18
71.92
79.15
81.44
91.36
78.05
67.94
66.36
65.44
61.58
65.89
60.59
60.33
62.36
62.11
64.07
58.87
61.64
63.98
52.55
55.07
60.55
59.31
65.86
64.66
55.01
57.12
58.21
55.77
55.82
64.67
66.54
67.83
68.18
55.8
66.34
65.77
60.54
62.71
70.64
78.31
90.24
90.3
87.08
87.64
85.73
82.23
79.37
81.31
70.51
63.07
61.66
63.69
62.03
64.73
66.21
60.64
60.51
63.66
62.15
66.45
71.17
79.26
82.23
87.14
87.32
85.75
83.66
81.35
76.66
75.34
78.65
78.03
75.2
77.29
78.22
85.49
77.4
74.43
74.0
74.73
79.13
72.06
81.81
74.88
72.54
68.59
71.83
75.06
77.03
83.99
84.58
81.88
82.69
72.93
69.67
73.31
70.61
71.68
76.07
65.7
68.7
80.85
85.69
89.75
84.41
81.04
76.02
76.52
71.53
72.92
78.28
73.75
81.58
74.94
80.45
71.53
76.81
71.4
78.01
71.83
76.23
73.9
71.28
68.61
71.07
77.4
70.25
73.55
70.23
73.21
65.35
69.69
73.95
70.86
71.42
70.84
75.6
72.86
72.43
74.5
75.23
75.16
80.09
76.62
78.23
75.82
78.63
82.54
74.12
68.2
66.26
55.75
52.24
50.46
52.01
65.19
70.23
74.0
75.04
70.23
80.0
85.49
82.09
50.27
52.76
44.21
46.43
49.12
50.6
50.52
42.2
47.25
51.68
49.26
58.12
54.7
55.45
50.68
53.52
54.12
55.16
54.47
56.48
51.81
62.49
56.91
61.49
65.62
62.33
58.68
56.31
53.14
61.85
66.71
69.83
70.72
66.81
74.57
75.98
66.66
69.31
69.36
67.49
66.46
69.49
65.53
63.93
58.83
56.02
57.56
65.77
61.83
60.86
60.55
62.9
56.48
65.54
62.35
58.7
59.66
59.01
56.72
58.39
57.27
62.64
62.05
62.46
67.5
71.59
66.7
63.66
65.56
69.66
60.99
70.0
72.17
77.0
76.0
70.56
64.13
68.8
61.27
60.04
67.25
63.55
73.21
70.76
68.98
65.27
54.11
50.77
55.53
58.83
63.48
65.67
72.54
74.35
71.58
76.67
66.94
72.2
70.82
71.71
65.66
68.85
72.94
67.46
65.73
67.5
68.19
75.17
70.75
66.74
66.99
64.68
69.66
61.25
61.04
70.73
73.66
70.78
70.26
72.17
67.61
68.46
68.07
69.66
63.35
66.36
68.23
62.79
60.5
70.85
67.41
67.51
64.82
69.24
66.13
60.35
57.34
61.53
59.44
58.22
57.33
];

% Sampling frequency in Hz (1 Hz in your case)
fs = 1;

% FFT calculation
fft_result = fft(BeatAVG_data);

% Calculation of corresponding frequencies
N = length(fft_result);
frequencies = linspace(0, fs, N);

% Plotting the FFT
subplot(2, 1, 1); % Create a subplot with 2 rows and 1 column (to display the FFT)
plot(frequencies, abs(fft_result))
xlabel('Frequency (Hz)')
ylabel('Amplitude')
title('FFT of Signal BeatAVG')

% Define a low-pass FIR filter
cutoff_frequency = 0.1; % Cutoff frequency in Hz 
filter_order = 30; % Filter order
b = fir1(filter_order, cutoff_frequency/(fs/2), 'low'); % Create the FIR filter

% Apply convolution with the FIR filter
convolution_result = conv(BeatAVG_data, b, 'same');

% Plot the convolution
subplot(2, 1, 2); % Second subplot
plot(BeatAVG_data)
hold on
plot(convolution_result)
xlabel('Time')
ylabel('Amplitude')
title('Convolution with FIR Filter')
legend('Original Signal', 'Convolved Signal')

% Display both plots side by side
subplot(2, 1, 1); % Return to the first subplot

% Exportation des coefficients du filtre
save('fir_coefficients.txt', 'b', '-ascii');